---
title: "Mental Effort and Conscious Cognitive Event Rate"
format:
  html:
    sanitize: false
resources:
  - "*.html"
---

[← Back to Projects](../projects.qmd){.button}

How does mental effort adjust over time to keep thinking on track?  
This page sketches a small toy model where *mental effort* acts like a control signal, trying to keep the **conscious cognitive event rate** (how many task-relevant, consciously accessible operations you complete per unit time) inside a desirable band. When performance drops, effort ramps up; when things feel easy, effort relaxes.

Below, you can explore the model in three static examples that show how task difficulty, responsiveness of effort, and feedback lag shape the dynamics.

---

## Toy theory

We model **mental effort** as a control signal that tries to keep the  
**conscious cognitive event rate** (CCER) in a desirable range.

- Time is discretised in 1-second steps.
- For each second we have a **task difficulty** value in `[0, 1]`:
  - `0` = very easy (high baseline CCER even with little effort)
  - `1` = very hard (low baseline CCER unless effort is high)
- Difficulty determines a **baseline event rate**. In R terms you can think of it as:

  ```r
  baseline_event_rate <- function(
    task_difficulty,
    base_event_rate_min = 0.2,  # very hard
    base_event_rate_max = 0.8   # very easy
  ) {
    base_event_rate_max - task_difficulty * (base_event_rate_max - base_event_rate_min)
  }
  ```

- Actual CCER is the baseline plus a contribution from effort:

  ```r
  conscious_event_rate_t <-
    baseline_event_rate(task_difficulty_t) +
    effort_influence_on_event_rate * (previous_effort - neutral_effort_level)
  ```

- Effort adjusts in response to CCER relative to a target, with a lag:

  ```r
  lagged_index      <- max(1L, current_time_index - feedback_lag_steps)
  lagged_event_rate <- event_rate_history[lagged_index]
  event_rate_error  <- target_event_rate - lagged_event_rate

  mental_effort_t <-
    mental_effort_previous +
    effort_adjustment_rate * event_rate_error * time_step_seconds
  ```

If CCER has recently been **below** the target band, `event_rate_error` is positive and
effort ramps **up**; if CCER has been **above** the band, `event_rate_error` is negative and
effort ramps **down**. In code, both effort and CCER are usually clipped to `[0, 1]`:

```r
mental_effort_t        <- pmin(1, pmax(0, mental_effort_t))
conscious_event_rate_t <- pmin(1, pmax(0, conscious_event_rate_t))
```

---

## Setup and simulation function

```{r setup, include=FALSE}
# Load libraries
library(plotly)

# Simulate how mental effort adjusts to keep conscious cognitive event rate (CCER)
# within a target band, given a time series of task difficulties.
simulate_mental_effort_and_conscious_event_rate <- function(
  task_difficulty_vector,
  initial_mental_effort          = 0.5,  # starting mental effort (0–1)
  initial_event_rate             = 0.5,  # starting conscious event rate (0–1)
  target_event_rate              = 0.5,  # desired event rate (e.g., middle of target band)
  time_step_seconds              = 1.0,  # time step in seconds
  feedback_lag_seconds           = 1.0,  # delay before performance feeds back into effort
  effort_adjustment_rate         = 0.4,  # how fast effort responds to event-rate error
  effort_influence_on_event_rate = 0.8,  # how strongly effort boosts event rate
  base_event_rate_min            = 0.2,  # baseline event rate for very hard tasks
  base_event_rate_max            = 0.8   # baseline event rate for very easy tasks
) {
  # Ensure difficulty is numeric
  task_difficulty_vector <- as.numeric(task_difficulty_vector)
  total_time_steps <- length(task_difficulty_vector)

  # Output vectors
  mental_effort        <- numeric(total_time_steps)
  conscious_event_rate <- numeric(total_time_steps)

  # Initial conditions
  mental_effort[1]        <- initial_mental_effort
  conscious_event_rate[1] <- initial_event_rate

  # Convert feedback lag (seconds) to lag in time steps
  lag_steps <- max(1L, round(feedback_lag_seconds / time_step_seconds))
  neutral_effort_level <- 0.5

  # Baseline event rate as a function of difficulty (0 = easy, 1 = hard)
  baseline_event_rate <- function(task_difficulty) {
    base_event_rate_max - task_difficulty * (base_event_rate_max - base_event_rate_min)
  }

  for (time_index in 2:total_time_steps) {
    current_difficulty <- task_difficulty_vector[time_index]

    # 1) Conscious event rate from previous effort & current difficulty
    event_rate_baseline <- baseline_event_rate(current_difficulty)
    conscious_event_rate[time_index] <-
      event_rate_baseline +
      effort_influence_on_event_rate * (mental_effort[time_index - 1] - neutral_effort_level)

    # Clip to [0, 1]
    conscious_event_rate[time_index] <-
      min(1, max(0, conscious_event_rate[time_index]))

    # 2) Effort updated from lagged event rate (feedback)
    feedback_index <- max(1L, time_index - lag_steps)
    event_rate_error <-
      target_event_rate - conscious_event_rate[feedback_index]

    mental_effort[time_index] <-
      mental_effort[time_index - 1] +
      effort_adjustment_rate * event_rate_error * time_step_seconds

    # Clip to [0, 1]
    mental_effort[time_index] <-
      min(1, max(0, mental_effort[time_index]))
  }

  data.frame(
    time_seconds         = seq_len(total_time_steps) - 1,
    task_difficulty      = task_difficulty_vector,
    mental_effort        = mental_effort,
    conscious_event_rate = conscious_event_rate
  )
}
```

---

## Example 1: Baseline pattern (easy–hard–easy–hard–easy)

We start with five sequential tasks, each lasting 4 seconds (20 seconds total):

- Task 1: **easy**  
- Task 2: **hard**  
- Task 3: **easy**  
- Task 4: **hard**  
- Task 5: **easy**

Difficulty is encoded between 0 (very easy) and 1 (very hard).  
Here we use: easy ≈ `0.3`, hard ≈ `0.8`.

```{r example1, echo=FALSE}
# Difficulty for 5 tasks × 4 seconds each
baseline_task_difficulties      <- c(0.3, 0.8, 0.3, 0.8, 0.3)
baseline_difficulty_vector      <- rep(baseline_task_difficulties, each = 4)

target_event_rate_band <- c(0.4, 0.6)
target_event_rate      <- mean(target_event_rate_band)

baseline_simulation <- simulate_mental_effort_and_conscious_event_rate(
  task_difficulty_vector         = baseline_difficulty_vector,
  initial_mental_effort          = 0.3,
  initial_event_rate             = 0.5,
  target_event_rate              = target_event_rate,
  time_step_seconds              = 1.0,
  feedback_lag_seconds           = 1.0,
  effort_adjustment_rate         = 0.4,
  effort_influence_on_event_rate = 0.8,
  base_event_rate_min            = 0.2,
  base_event_rate_max            = 0.8
)

total_seconds_example1 <- nrow(baseline_simulation)
task_boundaries        <- seq(0, total_seconds_example1, by = 4)
task_labels            <- paste("Task", seq_len(5))

p1 <- plot_ly()

# Mental effort (left axis)
p1 <- add_lines(
  p1,
  data = baseline_simulation,
  x = ~time_seconds,
  y = ~mental_effort,
  name = "Mental effort",
  yaxis = "y"
)

# CCER markers (right axis)
p1 <- add_markers(
  p1,
  data = baseline_simulation,
  x = ~time_seconds,
  y = ~conscious_event_rate,
  name = "Conscious cognitive event rate",
  yaxis = "y2"
)

# Shapes: target band + task boundaries
band_shape <- list(
  type = "rect",
  x0 = 0, x1 = max(baseline_simulation$time_seconds),
  xref = "x",
  y0 = target_event_rate_band[1], y1 = target_event_rate_band[2],
  yref = "y2",
  fillcolor = "rgba(255, 200, 0, 0.25)",
  line = list(width = 0)
)

boundary_shapes <- lapply(task_boundaries, function(boundary_time) {
  list(
    type = "line",
    x0 = boundary_time, x1 = boundary_time,
    xref = "x",
    y0 = 0, y1 = 1,
    yref = "paper",
    line = list(color = "rgba(150,150,150,0.5)", dash = "dot", width = 1)
  )
})

all_shapes <- c(list(band_shape), boundary_shapes)

p1 <- layout(
  p1,
  title = "Example 1: Baseline pattern (easy–hard–easy–hard–easy)",
  xaxis = list(title = "Seconds", zeroline = FALSE),
  yaxis = list(title = "Mental effort", range = c(0, 1)),
  yaxis2 = list(
    title = "Conscious cognitive event rate",
    overlaying = "y",
    side = "right",
    range = c(0, 1)
  ),
  shapes = all_shapes,
  legend = list(x = 0.02, y = 0.98)
)

# Add task labels
for (task_index in seq_len(5)) {
  middle_of_task <- (task_boundaries[task_index] + task_boundaries[task_index + 1]) / 2
  p1 <- add_annotations(
    p1,
    x = middle_of_task, y = -0.12,
    xref = "x", yref = "paper",
    text = task_labels[task_index],
    showarrow = FALSE,
    yanchor = "top"
  )
}

p1
```

---

## Example 2: Changing the effort adjustment rate

Here we keep the difficulty pattern the same, but compare:

- **Low effort adjustment rate**: effort is slow to respond to CCER errors.  
- **High effort adjustment rate**: effort reacts quickly and can overshoot.

```{r example2, echo=FALSE}
# Use the same baseline_difficulty_vector and target_event_rate_band / target_event_rate

low_adjustment_sim <- simulate_mental_effort_and_conscious_event_rate(
  task_difficulty_vector         = baseline_difficulty_vector,
  initial_mental_effort          = 0.3,
  initial_event_rate             = 0.5,
  target_event_rate              = target_event_rate,
  time_step_seconds              = 1.0,
  feedback_lag_seconds           = 1.0,
  effort_adjustment_rate         = 0.2,  # low adjustment
  effort_influence_on_event_rate = 0.8,
  base_event_rate_min            = 0.2,
  base_event_rate_max            = 0.8
)

high_adjustment_sim <- simulate_mental_effort_and_conscious_event_rate(
  task_difficulty_vector         = baseline_difficulty_vector,
  initial_mental_effort          = 0.3,
  initial_event_rate             = 0.5,
  target_event_rate              = target_event_rate,
  time_step_seconds              = 1.0,
  feedback_lag_seconds           = 1.0,
  effort_adjustment_rate         = 0.8,  # high adjustment
  effort_influence_on_event_rate = 0.8,
  base_event_rate_min            = 0.2,
  base_event_rate_max            = 0.8
)

p2 <- plot_ly()

# Mental effort: low adjustment
p2 <- add_lines(
  p2,
  data = low_adjustment_sim,
  x = ~time_seconds,
  y = ~mental_effort,
  name = "Effort (adjustment rate = 0.2)",
  yaxis = "y"
)

# Mental effort: high adjustment
p2 <- add_lines(
  p2,
  data = high_adjustment_sim,
  x = ~time_seconds,
  y = ~mental_effort,
  name = "Effort (adjustment rate = 0.8)",
  yaxis = "y",
  line = list(dash = "dash")
)

# CCER: low adjustment
p2 <- add_markers(
  p2,
  data = low_adjustment_sim,
  x = ~time_seconds,
  y = ~conscious_event_rate,
  name = "CCER (adjustment rate = 0.2)",
  yaxis = "y2"
)

# CCER: high adjustment
p2 <- add_markers(
  p2,
  data = high_adjustment_sim,
  x = ~time_seconds,
  y = ~conscious_event_rate,
  name = "CCER (adjustment rate = 0.8)",
  yaxis = "y2",
  marker = list(symbol = "triangle-up")
)

band_shape2 <- list(
  type = "rect",
  x0 = 0, x1 = max(low_adjustment_sim$time_seconds),
  xref = "x",
  y0 = target_event_rate_band[1], y1 = target_event_rate_band[2],
  yref = "y2",
  fillcolor = "rgba(255, 200, 0, 0.25)",
  line = list(width = 0)
)

p2 <- layout(
  p2,
  title = "Example 2: Effect of effort adjustment rate",
  xaxis = list(title = "Seconds", zeroline = FALSE),
  yaxis = list(title = "Mental effort", range = c(0, 1)),
  yaxis2 = list(
    title = "Conscious cognitive event rate",
    overlaying = "y",
    side = "right",
    range = c(0, 1)
  ),
  shapes = list(band_shape2),
  legend = list(x = 0.02, y = 0.98)
)

p2
```

---

## Example 3: Changing the feedback lag

Now we vary **feedback lag**: how long it takes before deviations in CCER feed back into changes in effort.

We compare:

- **Short lag**: `0.5` seconds  
- **Long lag**: `2` seconds  

```{r example3, echo=FALSE}
short_lag_sim <- simulate_mental_effort_and_conscious_event_rate(
  task_difficulty_vector         = baseline_difficulty_vector,
  initial_mental_effort          = 0.3,
  initial_event_rate             = 0.5,
  target_event_rate              = target_event_rate,
  time_step_seconds              = 1.0,
  feedback_lag_seconds           = 0.5,  # short lag
  effort_adjustment_rate         = 0.4,
  effort_influence_on_event_rate = 0.8,
  base_event_rate_min            = 0.2,
  base_event_rate_max            = 0.8
)

long_lag_sim <- simulate_mental_effort_and_conscious_event_rate(
  task_difficulty_vector         = baseline_difficulty_vector,
  initial_mental_effort          = 0.3,
  initial_event_rate             = 0.5,
  target_event_rate              = target_event_rate,
  time_step_seconds              = 1.0,
  feedback_lag_seconds           = 2.0,  # long lag
  effort_adjustment_rate         = 0.4,
  effort_influence_on_event_rate = 0.8,
  base_event_rate_min            = 0.2,
  base_event_rate_max            = 0.8
)

p3 <- plot_ly()

# Mental effort: short lag
p3 <- add_lines(
  p3,
  data = short_lag_sim,
  x = ~time_seconds,
  y = ~mental_effort,
  name = "Effort (feedback lag = 0.5 s)",
  yaxis = "y"
)

# Mental effort: long lag
p3 <- add_lines(
  p3,
  data = long_lag_sim,
  x = ~time_seconds,
  y = ~mental_effort,
  name = "Effort (feedback lag = 2 s)",
  yaxis = "y",
  line = list(dash = "dash")
)

# CCER: short lag
p3 <- add_markers(
  p3,
  data = short_lag_sim,
  x = ~time_seconds,
  y = ~conscious_event_rate,
  name = "CCER (feedback lag = 0.5 s)",
  yaxis = "y2"
)

# CCER: long lag
p3 <- add_markers(
  p3,
  data = long_lag_sim,
  x = ~time_seconds,
  y = ~conscious_event_rate,
  name = "CCER (feedback lag = 2 s)",
  yaxis = "y2",
  marker = list(symbol = "triangle-up")
)

band_shape3 <- list(
  type = "rect",
  x0 = 0, x1 = max(short_lag_sim$time_seconds),
  xref = "x",
  y0 = target_event_rate_band[1], y1 = target_event_rate_band[2],
  yref = "y2",
  fillcolor = "rgba(255, 200, 0, 0.25)",
  line = list(width = 0)
)

p3 <- layout(
  p3,
  title = "Example 3: Effect of feedback lag",
  xaxis = list(title = "Seconds", zeroline = FALSE),
  yaxis = list(title = "Mental effort", range = c(0, 1)),
  yaxis2 = list(
    title = "Conscious cognitive event rate",
    overlaying = "y",
    side = "right",
    range = c(0, 1)
  ),
  shapes = list(band_shape3),
  legend = list(x = 0.02, y = 0.98)
)

p3
```

---

## Disengagement and giving up

So far, the toy model assumes the individual **always keeps trying**: effort keeps adjusting to reduce the gap between CCER and the target band. In real behaviour, however, there are at least two qualitatively different “failure modes”:

1. **Over-effort with discomfort (disengaging due to strain)**  
2. **Persistent failure to reach the target (giving up)**

### 1. Disengagement due to sustained high effort

If the system pushes mental effort **too high for too long**, without bringing CCER into the target range, the individual may **disengage** from the task. Subjectively, this could correspond to increased feelings of strain, nausea, or general aversion.

One simple way to detect this in code is to define:

```r
effort_discomfort_threshold <- 0.8   # above this effort feels aversive
max_discomfort_duration     <- 10    # seconds tolerated at that level
```

…and then track how many consecutive seconds effort has been above that threshold *while event rate is outside the target band*.

### 2. Giving up when increased effort doesn’t help

A different pattern is “giving up” even if the person is *willing* to exert effort, because the system learns that **extra effort is ineffective** for this task.

In code, you could look at sliding windows of effort and error:

```r
window_size <- 20  # how many seconds we look back over

# Example structure for computing windowed averages:
# mean_effort      <- mean(mental_effort[start_index:end_index])
# mean_sq_error    <- mean((target_event_rate - conscious_event_rate[start_index:end_index])^2)
# and compare to thresholds.
```

If average effort has been high, and average squared error is still large, the system may transition into a “gave up” state.

### 3. Putting it together conceptually

In a more complete version of the toy theory, we would have:

- A **continuous control process** (the current model) that adjusts effort to stabilise CCER.
- On top of that, a **meta-control layer** with discrete states:
  - *Engaged and regulating* (normal operation)
  - *Disengaged due to discomfort* (effort was too high for too long, with no success)
  - *Gave up* (effort has been high, but CCER error remains large and persistent)

This gives a way to talk about:

- **Acute strain** (high effort + low CCER → disengagement), and  
- **Chronic failure** (sustained high effort + sustained poor performance → giving up),

without changing the core dynamics of effort and CCER; instead, you add **criteria that switch the system into qualitatively different regimes** once certain thresholds are crossed.

---

[← Back to Projects](../projects.qmd){.button}
